<my-app>loading</my-app>

<textarea id="MyID"></textarea>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
<script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
<script>
var simplemde = new SimpleMDE({
  	toolbar: [{
			name: "image",
			action: insertImage,
			className: "fa fa-picture-o",
			title: "画像挿入"
		},
    '|',
    'bold',
    'italic',
    'heading',
    '|',
    'quote',
    'unordered-list',
    'ordered-list',
    '|',
    'link',
    '|',
    'preview',
    'side-by-side',
    'fullscreen',
    '|',
    'guide',
    ]
});

function insertImage(el) {
  let self = this;
  console.log(simplemde);

  let inputEle = document.createElement('input');
  inputEle.setAttribute('type', 'file');
  inputEle.setAttribute('accept', 'image/*');
  inputEle.click();

  inputEle.onchange = (e) => {
    var file = e.target.files[0];

    var reader = new FileReader();
    reader.readAsDataURL(file);
  
    reader.onload = function() {
        var line = simplemde.codemirror.getCursor().line;
        var ch = simplemde.codemirror.getCursor().ch;

        var dataUri = reader.result;
        let cm = simplemde.codemirror;
        let stat = simplemde.getState();
        let options = simplemde.options;

        simplemde.codemirror.replaceSelection(cm, stat.iamge,options.insertTexts.image, dataUri)
    }
  }
}
</script>


<div id="marked"></div>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    document.getElementById('marked').innerHTML =
      marked('# Marked in the browser\n\nRendered by **marked**.');
  </script>